/* (c) https://github.com/MontiCore/monticore */
plugins {
  id "java-library"
  id "maven-publish"
}
group = "de.monticore"

dependencies {
  // Use the previous monticore runtime
  implementation "de.monticore:monticore-runtime:$previous_mc_version"
  // but the current se-commons
  implementation 'de.se_rwth.commons:se-commons-logging:' + se_commons_version
  // Due to this, some fixes are required - see src/main/java
}

repositories {
  if (("true").equals(getProperty('useLocalRepo'))) {
    mavenLocal()
  }
  maven {
    url repo
  }
  mavenCentral()
}

tasks.withType(JavaCompile) {
  sourceCompatibility = JavaVersion.VERSION_11
  targetCompatibility = JavaVersion.VERSION_11
  options.encoding = "UTF-8"
  options.deprecation false
  options.warnings = false
}
java {
  withSourcesJar()
  toolchain {
    languageVersion = JavaLanguageVersion.of(11)
  }
}

publishing {
  publications {
    maven(MavenPublication) {
      groupId = project.group
      artifactId = 'monticore-previous-runtime-fix'
      version = project.version
      from components.java
    }
  }
  repositories.maven {
    credentials.username mavenUser
    credentials.password mavenPassword
    def releasesRepoUrl = "https://nexus.se.rwth-aachen.de/content/repositories/monticore-releases/"
    def snapshotsRepoUrl = "https://nexus.se.rwth-aachen.de/content/repositories/monticore-snapshots/"
    url = version.endsWith('SNAPSHOT') ? snapshotsRepoUrl : releasesRepoUrl
  }
}
